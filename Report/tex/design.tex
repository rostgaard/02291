\chapter{Design}
%This section contains the design of the system. It is only necessary to create a design realizing the use cases identified in Sect. 4. Explain any non-trivial design decision that you make, and state any assumptions that you make. 2
\noindent

\section{Component Design}
%Define the components of the system with their ports (i.e., a port is a set of required and provided   interfaces). For each provided interface of a port provide the protocol state machine. For hardware components that one would buy off the shelf, like antenna, ticket reader, barrier, . . . , it is sufficient to provide the ports with their protocol state machines without going into the details of their possible implementation.

\begin{figure}
  \includegraphics[scale=0.37]{\imgdir "System"}
  \caption{Component diagram}
  \label{fig:component_diagram}
\end{figure}

The component architecture is based on three main components and three helpers. 
The main components are:
\begin{itemize}
\item \textbf{Toll Lane} - this subsystem encapsulates Toll Booth component, which heart is the Cash Register. It provides or requires interfaces from all of the hardware located in or around the booth, like Credit Card Reader, Ticket Printer or Antenna. It communicates with the Toll Station Server by bidirectional interface, which allows to exchange information like current price or checked tickets and tags.
\item \textbf{Toll Station} - this subsystem consists of only two elements - the server, responsible for synchronizing with Enterprise Server and Cash Register, and the client, that is used by Manager to print reports or submitting the forms. The communication between servers provides Station Servers with informations, that are stored locally: current, registered subscriptions and prices, and allows for monthly synchronization of checks and sold tickets. 
\item \textbf{Enterprise Server} - this component controls the flow of data. It collects the forms submitted by the Website. It provides the data for management client and accepts its request for price changing and notification sending. It is also responsible for calculating and processing the monthly payment for toll tags' owners.
\end{itemize}
The helpers are:
\begin{itemize}
\item \textbf{Bank} - this component not implemented by our application. It offers interfaces for Credit Card Reader and Enterprise for processing credit card payments. It also provides the system with physical credit card reader devices.
\item \textbf{Management Client} - it allows Enterprise Managers to change the prices, send notification for customers or generate reports. It communicates with Enterprise Server and Report Generator. 
\item \textbf{Webserver} - this component is hosting the website for customers for ordering and managing their toll tags. It uses Enterprise interfaces to inform about new toll tags requests. 
\end{itemize}


\section{Class Design}
%Define the classes used to implement the components. Some components can be implemented as a single classes; other components can be implemented by a set of classes. Provide any necessary class invariants using OCL constraints. Specify the contracts of non-trivial operations using OCL constraints (pre:/post:). Describe each class, their interaction, and the contract of operations also using informal text. Note that for hardware components that one would buy off the shelf, like antenna, ticket reader, barrier, ... , it is not necessary to detail their implementation (cf. Sect. 4).
The detailed class design includes all the interfaces introduced in component diagram and most of the concepts presented in the domain model. 
The classes has following interactions and contracts:
\begin{itemize}
\item Antenna - it's a hardware device, that is contacting the Cash Register to inform about toll tag that it registered.
\item Bank - a representation of outer company, that provides interfaces for credit card and monthly payments. 
\item Barrier - it's a hardware device, that provides the interface for Cash Register for opening/closing.
\item Cash Register - this part is responsible for contacting with all the devices in and around tool booth. It calculates the prices of tickets and manages the work flow, e.g. receives input from antenna, then calls barrier to open and closes it after the customer is leaving. It receives input from Ticket Reader and Antenna, sends data to: Ticket Printer, Touch Screen, Toll Station Server, Indicator, Credit Card Reader (expected confirmation) and it also reads data from: Touch Screen and Toll Station Server.
\item Credit Card Reader - a hardware device, provided by Bank. It provides the interface that allows Cash Register to withdraw specified amount of money and receives confirmation.
\item Indicator - simple hardware device for indicating Cashier's presence in the tool booth, updated by Cash Register.
\item Ticket Printer - simple printer for printing tickets, that receives the data from Cash Register
\item Ticket Reader - it is hardware device, that reads the ticket and sends data to Cash Register.
\
\item Touch Screen - hardware device connected to the Cash Register, that allows Cashier to interacts with system. It exchanges information with Cash Register in both direction, informing about user's action and fetching the feedback. 

\end{itemize}


\section{Behaviour Design}
%Describe the behaviour of each non-trivial class using object life cycle state machines.